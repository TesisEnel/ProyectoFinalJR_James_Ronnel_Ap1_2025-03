@page "/sugerencias"
@attribute [Authorize(Roles = "Admin, Usuario")]

@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager NavigationManager

<AuthorizeView>
    <Authorizing>
        <p>Verificando permisos...</p>
    </Authorizing>
    <Authorized>
        @{
            var user = context.User;

            if (user.IsInRole("Admin"))
            {
                // Si es Admin, va a la bandeja de administración
                NavigationManager.NavigateTo("/admin/sugerencias", forceLoad: true);
            }
            else if (user.IsInRole("Usuario"))
            {
                // Si es Usuario, va a la página de creación
                NavigationManager.NavigateTo("/sugerencias/crear", forceLoad: true);
            }
            else
            {
                // Si está logueado pero no tiene un rol válido (Admin o Usuario), va a Home
                NavigationManager.NavigateTo("/", forceLoad: true);
            }
        }
    </Authorized>
    <NotAuthorized>
        <p>Redirigiendo a Login...</p>
        @{
            NavigationManager.NavigateTo("/Account/Login", forceLoad: true);
        }
    </NotAuthorized>
</AuthorizeView>